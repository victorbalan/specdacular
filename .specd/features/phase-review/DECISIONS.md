# Decisions: phase-review

**Feature:** phase-review
**Created:** 2026-02-09
**Last Updated:** 2026-02-09
**Decisions:** 6

---

## Active Decisions

### DEC-001: Claude inspects first, then user weighs in

**Date:** 2026-02-09
**Status:** Active
**Context:** Needed to decide who drives the review — user telling Claude what's wrong, Claude inspecting automatically, or both
**Decision:** Both in sequence — Claude does automated inspection of plans vs actual code first, then asks the user for input on satisfaction and desired changes
**Rationale:**
- Claude can do the mechanical work (diff plans vs code) without the user having to remember every change
- But Claude can't know if the user is satisfied — that's subjective human judgment
- Sequential approach gives the user a starting point to react to rather than a blank prompt
**Implications:**
- Workflow needs to read plan files and inspect the code they reference
- Review output must be structured enough for user to quickly scan and respond
- Conversation phase needs to capture new decisions and deviations

---

### DEC-002: Command named `phase:review`

**Date:** 2026-02-09
**Status:** Active
**Context:** Initial name was "verify-phase" but that implies binary pass/fail
**Decision:** Name the command `/specd.phase:review` to match existing namespace pattern
**Rationale:**
- "Review" implies both inspection and conversation, which matches the feature's nature
- Consistent with `phase:prepare`, `phase:plan`, `phase:execute`
- "Verify" is too rigid — this is iterative refinement, not a gate check
**Implications:**
- Command file: `commands/specd.phase-review.md`
- Workflow file: `specdacular/workflows/review-phase.md`

---

### DEC-003: Corrective plans continue the sequence numbering

**Date:** 2026-02-09
**Status:** Active
**Context:** Needed to decide how corrective plans (generated by review) integrate with existing phase plans
**Decision:** Corrective plans continue the existing numbering sequence (e.g., 04-PLAN.md, 05-PLAN.md) with a `corrects: [01, 03]` field in YAML frontmatter for traceability
**Rationale:**
- Execute-plan already finds "first incomplete plan" — no changes needed
- `corrects` frontmatter field links fixes back to original plans without requiring naming changes
- Simpler than sub-numbering (03.1) or suffix naming (03-FIX) which both need execute-plan updates
**Implications:**
- Plan template YAML frontmatter gains optional `corrects` field
- Review workflow generates plans with standard naming + corrects metadata
- Execute-plan works as-is with no modifications

---

### DEC-004: Review cycles tracked in new STATE.md section

**Date:** 2026-02-09
**Status:** Active
**Context:** Needed to decide how STATE.md represents review status and history
**Decision:** Add a new "Review Cycles" section to STATE.md with a table tracking each review cycle (phase, cycle number, date, findings count, corrective plans, status)
**Rationale:**
- Preserves full history of review iterations (how many cycles it took to get clean)
- Separate from Plan Status table keeps concerns isolated
- Status dashboard can read this to show review state
**Implications:**
- STATE.md template needs new Review Cycles section
- Phase completion requires last review cycle status = `clean`
- Status command can show review state per phase

---

### DEC-005: Review output uses per-plan status table with expandable details

**Date:** 2026-02-09
**Status:** Active
**Context:** Needed to define the user-facing output format for review findings
**Decision:** Per-plan status table (✅ Match / ⚠️ Deviation / ❌ Incomplete) followed by expanded detail sections for deviations and issues, then user input phase
**Rationale:**
- Table gives quick scan of overall health
- Expanded sections provide context only for items needing attention
- User input phase captures subjective satisfaction and additional issues
**Implications:**
- Workflow must read each plan's expected file changes and inspect actual code
- Output format needs to be consistent across review cycles
- User conversation phase must capture new decisions and additional issues

---

### DEC-006: Partial execution review supported

**Date:** 2026-02-09
**Status:** Active
**Context:** Needed to decide whether review requires all plans to be executed first
**Decision:** Support partial review — only inspect plans with status `Complete` in STATE.md, show unexecuted plans as "Not yet executed" without treating them as issues
**Rationale:**
- Users may want to sanity-check early before committing to remaining plans
- A deviation in plan 01 might affect plans 03 and 04 — catching it early is valuable
- The execute → review loop works naturally with partial execution
**Implications:**
- Review workflow filters plans by completion status from STATE.md
- Review cycle status (clean/fixes-pending) is relative to executed plans only
- Unexecuted plans shown in table but grayed out / marked as pending

---

## Superseded Decisions

---

## Revoked Decisions

---

## Decision Log

| ID | Date | Title | Status |
|----|------|-------|--------|
| DEC-001 | 2026-02-09 | Claude inspects first, then user weighs in | Active |
| DEC-002 | 2026-02-09 | Command named phase:review | Active |
| DEC-003 | 2026-02-09 | Corrective plans continue the sequence numbering | Active |
| DEC-004 | 2026-02-09 | Review cycles tracked in new STATE.md section | Active |
| DEC-005 | 2026-02-09 | Review output uses per-plan status table with expandable details | Active |
| DEC-006 | 2026-02-09 | Partial execution review supported | Active |
