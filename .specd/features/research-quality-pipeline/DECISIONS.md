# Decisions: research-quality-pipeline

**Feature:** research-quality-pipeline
**Created:** 2026-02-06
**Last Updated:** 2026-02-06

---

## Active Decisions

### DEC-001: Three-tier confidence system (HIGH/MEDIUM/LOW)

**Date:** 2026-02-06
**Status:** Active
**Phase:** 0
**Context:** Research agents produce findings with varying reliability. Need a consistent way to signal confidence through the pipeline.
**Decision:** Use three confidence tiers tied to verification source: HIGH (codebase-verified), MEDIUM (official docs), LOW (community/unverified).
**Rationale:**
- Simple enough for Claude to apply consistently
- Tied to verifiable criteria (not subjective judgment)
- Maps directly to planning actions (use / recommend / verify first)
- Confidence can only maintain or lower during synthesis, never inflate
**Implications:**
- Research agents must tag every finding with confidence level
- RESEARCH.md template must include `**Confidence:**` field per finding
- Synthesis workflow must preserve confidence, not flatten it
- Planning workflows must act differently based on confidence tier

---

### DEC-002: Codebase docs staleness via metadata.json

**Date:** 2026-02-06
**Status:** Active
**Phase:** 0
**Context:** Codebase docs generated by `map-codebase` have no timestamps. Claude can't tell if they reflect current codebase state.
**Decision:** Add `.specd/codebase/metadata.json` with `generated_at`, `git_sha`, and `files_analyzed`. Workflows check staleness by comparing `git_sha` to current HEAD.
**Rationale:**
- Simple git comparison (no external tools)
- `git_sha` is an exact marker of codebase state at generation time
- Warning at >50 commits behind is a reasonable heuristic
- Doesn't block execution, just informs
**Implications:**
- `map-codebase` workflow must write `metadata.json` after generation
- All workflows that load codebase docs should check staleness
- Warning format: "Codebase docs may be stale (generated at {sha}, now {commits} commits behind). Consider `/specd.map-codebase --refresh`."

---

## Superseded Decisions

(none)

---

## Decision Log

| ID | Date | Title | Status |
|----|------|-------|--------|
| DEC-001 | 2026-02-06 | Three-tier confidence system (HIGH/MEDIUM/LOW) | Active |
| DEC-002 | 2026-02-06 | Codebase docs staleness via metadata.json | Active |
